# Complete-Intent-Detection-Pipeline-with-GPU-Support
High-performance Persian Intent Detection service using SetFit and FastAPI, optimized for GPU inference
# ๐ Persian Intent Detection Service (SetFit + FastAPI)

ุงู ูพุฑูฺู ฺฉ ุฑุงูฺฉุงุฑ ฺฉุงูู ุจุฑุง **ุชุดุฎุต ูุช (Intent Detection)** ุฏุฑ ุฒุจุงู ูุงุฑุณ ุงุณุช. ูุฏู ุงุตู ุงู ูพุฑูฺูุ ูพู ุฒุฏู ุจู ูุฏูโูุง ุณูฺฏู ุฒุจุงู ู ูุงุฒูุง ุนููุงุช (Production) ุจุง ุชูุฑฺฉุฒ ุจุฑ **ุณุฑุนุช ูพุงุณุฎฺฏู (Latency)** ู **ุฏูุช ุจุงูุง** ุฏุฑ ุณูุงุฑููุง ฺฉูโุฏุงุฏู (Few-shot) ุงุณุช.

## ๐ ูฺฺฏโูุง ฺฉูุฏ
- **SetFit Framework:** ุงุณุชูุงุฏู ุงุฒ Contrastive Learning ุจุฑุง ุขููุฒุด ุฏูู ุจุง ุฏุงุฏูโูุง ูุญุฏูุฏ.
- **Efficient Architecture:** ุงุณุชูุงุฏู ุงุฒ ูุณุฎูโูุง ุจููู ุดุฏู ูุฏูโูุง BERT ุจุฑุง ุฒุจุงู ูุงุฑุณ.
- **GPU Accelerated:** ุจูููโุณุงุฒ ุดุฏู ุจุฑุง ุงุฌุฑุง ุฑู NVIDIA RTX 4090 ุจุง ุงุณุชูุงุฏู ุงุฒ CUDA.
- **Production Ready:** ูพุงุฏูโุณุงุฒ ุณุฑูุณ ุจุง FastAPI ู ูุฏุฑุช ฺฉุงูุชูุฑ ุชูุณุท Docker.

## ๐ ุจูฺูุงุฑฺฉ ุนููฺฉุฑุฏ (Latency Comparison)
ุฏุฑ ุทูู ุชูุณุนูุ ูุง ูููู ุดุฏู ุจุง ุงูุชูุงู ุงุฒ CPU ุจู GPU ู ุจูููโุณุงุฒ ูพุงูพูุงูุ ุฒูุงู ูพุงุณุฎฺฏู ุฑุง ุจู ุดุฏุช ฺฉุงูุด ุฏูู:

| ูุงุฒ ุชูุณุนู | ูุฏู | ุณุฎุชโุงูุฒุงุฑ | ุฒูุงู ูพุงุณุฎฺฏู (Latency) | ูุถุนุช |
| :--- | :--- | :--- | :--- | :--- |
| **ฑ. ุงููู** | BERT-Base | CPU | ~ ฑฐ,ฐฐฐ ููโุซุงูู | โ ุบุฑุนููุงุช |
| **ฒ. ุจูููโุณุงุฒ ูุฏู** | Mini-BERT (SetFit) | CPU | ~ ด,ฐฐฐ ููโุซุงูู | โ๏ธ ฺฉูุฏ |
| **ณ. ููุง** | **Mini-BERT (SetFit)** | **RTX 4090 (GPU)** | **< ณฐฐ ููโุซุงูู** | โ ุงุฏูโุขู |

---

## ๐ ุณุงุฎุชุงุฑ ูพุฑูฺู
```text
.
โโโ app/
โ   โโโ main.py          # ุณุฑูุณ FastAPI ุจุฑุง ุงุณุชูุชุงุฌ (Inference)
โ   โโโ train.py         # ุงุณฺฉุฑูพุช ุขููุฒุด ูุฏู ุจุง SetFit
โโโ data/
โ   โโโ samples.json     # ููููู ุฏุงุฏูโูุง ุขููุฒุด
โโโ Dockerfile           # ุชูุธูุงุช ฺฉุงูุชูุฑ ุจุง ูพุดุชุจุงู ุงุฒ CUDA
โโโ requirements.txt     # ูพุดโูุงุฒูุง ฺฉุชุงุจุฎุงููโุง
โโโ README.md            # ุฑุงูููุง ูพุฑูฺู



ุฑุงูููุง ฺฏุงูโุจูโฺฏุงู ุฑุงูโุงูุฏุงุฒ
ูุฑุญูู ฑ: ูุตุจ ูพุดโูุงุฒูุง
ุงุจุชุฏุง ฺฉุชุงุจุฎุงููโูุง ููุฑุฏ ูุงุฒ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงู requirements ูุตุจ ฺฉูุฏ:

Bash

pip install -r requirements.txt
ูุฑุญูู ฒ: ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง (Training Data)
ุฏุงุฏูโูุง ุฎูุฏ ุฑุง ุฏุฑ ูุงูุจ ฺฉ ูุงู JSON ุฏุฑ ูพูุดู data/ ูุฑุงุฑ ุฏูุฏ. ูุฏู ุจุฑุง ุงุฏฺฏุฑ ูุชโูุง ุจู ุฌูุชโูุง (ูุชูุ ุจุฑฺุณุจ) ูุงุฒ ุฏุงุฑุฏ:

JSON

[
    {"text": "ูุฒูู ุณุฑูุณ ฺูุฏุฑ ุงุณุชุ", "label": "pricing"},
    {"text": "ฺุทูุฑ ูโุชูุงูู ุซุจุชโูุงู ฺฉููุ", "label": "signup"}
]
ูุฑุญูู ณ: ุขููุฒุด ูุฏู (Training)
ุจุฑุง ุดุฑูุน ูุฑุขูุฏ ุขููุฒุด ู ุฐุฎุฑู ูุฏู ููุง ุฏุฑ ูพูุดู model/:

Bash

python app/train.py
ูุฑุญูู ด: ุงุฌุฑุง ุณุฑูุณ (Inference)
ุณุฑูุฑ FastAPI ุฑุง ุจุฑุง ูพุงุณุฎฺฏู ุจู ุฏุฑุฎูุงุณุชโูุง API ุงุฌุฑุง ฺฉูุฏ:

Bash

python app/main.py
ุณุฑูุณ ุฑู ูพูุฑุช 8025 ูุนุงู ุฎูุงูุฏ ุดุฏ.

๐ณ ุงุณุชูุฑุงุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ Docker (GPU Support)
ุจุฑุง ุงุฌุฑุง ูพุฑูฺู ุฏุฑ ูุญุท ุงุฒููู ู ุจูุฑูโููุฏ ุงุฒ ูุฏุฑุช ูพุฑุฏุงุฒุด ฺฏุฑุงูฺฉ:

ฑ. ุจูุฏ ฺฉุฑุฏู Image:
Bash

docker build -t persian-intent-service .
ฒ. ุงุฌุฑุง Container ุจุง ุฏุณุชุฑุณ ุจู GPU:
Bash

docker run --gpus all -p 8025:8025 persian-intent-service
๐งช ุชุณุช ุณุฑูุณ (API Usage)
ูพุณ ุงุฒ ุงุฌุฑุงุ ูโุชูุงูุฏ ุจุง ุฏุณุชูุฑ curl ุฒุฑ ูุช ฺฉ ุฌููู ุฑุง ุจู ุตูุฑุช ุขู ุชุณุช ฺฉูุฏ:

Bash

curl -X POST "http://localhost:8025/predict" \
     -H "Content-Type: application/json" \
     -d '{"text": "ููุช ุงุดุชุฑุงฺฉ ูุงูุงูู ฺูุฏูุ"}'
ุฎุฑูุฌ ููููู:

JSON

{
  "intent": "pricing",
  "latency_ms": 285.4,
  "device": "NVIDIA RTX 4090"
}
